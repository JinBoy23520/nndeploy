# è§†é¢‘è¶…åˆ†å·¥ä½œæµä½¿ç”¨æŒ‡å—

æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•ä½¿ç”¨ä¸‰ç§ä¸åŒçš„è¶…åˆ†è¾¨ç‡æ¨¡å‹å·¥ä½œæµï¼šGFPGANã€Real-ESRGAN å’Œ SRResNet-liteã€‚

## ğŸ“‹ å·¥ä½œæµå¯¹æ¯”

| å·¥ä½œæµ | JSONæ–‡ä»¶ | æ¨¡å‹ | é€Ÿåº¦ (CPU) | è´¨é‡ | é€‚ç”¨åœºæ™¯ |
|--------|---------|------|-----------|------|---------|
| **GFPGAN** | `å®æ—¶è§†é¢‘è¶…åˆ†.json` | 50M | 2 FPS | â­â­â­â­â­ | äººè„¸ä¿®å¤,æœ€é«˜è´¨é‡ |
| **Real-ESRGAN** | `RealESRGANè§†é¢‘è¶…åˆ†.json` | 17M | 4-6 FPS | â­â­â­â­ | é€šç”¨è¶…åˆ†,å¹³è¡¡ |
| **SRResNet-lite** | `SRResNetè§†é¢‘è¶…åˆ†.json` | 5M | 20 FPS | â­â­â­ | å®æ—¶å¤„ç†,å¿«é€Ÿ |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼1: ä½¿ç”¨ GFPGAN (å½“å‰é»˜è®¤)

```bash
# 1. ç¡®ä¿å·²å¯åŠ¨æœåŠ¡
python app.py

# 2. è®¿é—® Web ç•Œé¢
# http://localhost:8080

# 3. åŠ è½½å·¥ä½œæµ
# é€‰æ‹©: resources/workflow/å®æ—¶è§†é¢‘è¶…åˆ†.json

# 4. è¿è¡Œå·¥ä½œæµ
# ç‚¹å‡»"è¿è¡Œ"æŒ‰é’®
```

### æ–¹å¼2: ä½¿ç”¨ Real-ESRGAN

```bash
# 1. å®‰è£…ä¾èµ–
pip install realesrgan basicsr

# 2. ä¸‹è½½æ¨¡å‹
# åˆ›å»ºç›®å½•
mkdir -p resources/models

# ä¸‹è½½ Real-ESRGAN x2 æ¨¡å‹ (17MB)
# Windows PowerShell:
Invoke-WebRequest -Uri "https://github.com/xinntao/Real-ESRGAN/releases/download/v0.2.1/RealESRGAN_x2plus.pth" -OutFile "resources\models\RealESRGAN_x2plus.pth"

# æˆ– Linux/Mac:
wget https://github.com/xinntao/Real-ESRGAN/releases/download/v0.2.1/RealESRGAN_x2plus.pth -P resources/models/

# 3. å¯åŠ¨æœåŠ¡
python app.py

# 4. åŠ è½½å·¥ä½œæµ
# åœ¨ Web ç•Œé¢é€‰æ‹©: resources/workflow/RealESRGANè§†é¢‘è¶…åˆ†.json
```

### æ–¹å¼3: ä½¿ç”¨ SRResNet-lite (æœ€å¿«)

```bash
# 1. å®‰è£… PyTorch (CPU ç‰ˆæœ¬)
pip install torch torchvision --index-url https://download.pytorch.org/whl/cpu

# æˆ– GPU ç‰ˆæœ¬ (å¦‚æœæœ‰ NVIDIA GPU)
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118

# 2. å¯åŠ¨æœåŠ¡ (æ— éœ€ä¸‹è½½æ¨¡å‹!)
python app.py

# 3. åŠ è½½å·¥ä½œæµ
# åœ¨ Web ç•Œé¢é€‰æ‹©: resources/workflow/SRResNetè§†é¢‘è¶…åˆ†.json

# æ³¨æ„: SRResNet ä½¿ç”¨éšæœºåˆå§‹åŒ–,è´¨é‡ä¸€èˆ¬,ä½†é€Ÿåº¦æœ€å¿«
```

---

## ğŸ“– è¯¦ç»†ä½¿ç”¨è¯´æ˜

### Real-ESRGAN å·¥ä½œæµ

#### èŠ‚ç‚¹è¯´æ˜

1. **OpenCvVideoDecode_1** (è§†é¢‘è¾“å…¥)
   - å‚æ•°: `path_` = è§†é¢‘æ–‡ä»¶è·¯å¾„
   - é»˜è®¤: `resources/videos/face.mp4`
   - å¯åœ¨ UI ä¸­ä¿®æ”¹

2. **RealESRGAN_2** (è¶…åˆ†èŠ‚ç‚¹)
   - å‚æ•°:
     - `model_path_`: æ¨¡å‹æ–‡ä»¶è·¯å¾„ (é»˜è®¤: `resources/models/RealESRGAN_x2plus.pth`)
     - `scale_`: è¶…åˆ†å€æ•° (2 æˆ– 4, é»˜è®¤: 2)
     - `tile_`: Tile æ¨¡å¼ (0=å…³é—­, >0 è¡¨ç¤º tile å°ºå¯¸)
   
3. **OpenCvImshow_3** (æ˜¾ç¤ºè¾“å‡º)
   - å‚æ•°: `window_name_` = çª—å£æ ‡é¢˜
   - å®æ—¶æ˜¾ç¤ºè¶…åˆ†ç»“æœ

#### ä¿®æ”¹æ¨¡å‹å€æ•°

ç¼–è¾‘ [RealESRGANè§†é¢‘è¶…åˆ†.json](../resources/workflow/RealESRGANè§†é¢‘è¶…åˆ†.json):

```json
{
    "name_": "RealESRGAN_2",
    "model_path_": "resources/models/RealESRGAN_x4plus.pth",  // æ”¹ä¸º x4 æ¨¡å‹
    "scale_": 4  // æ”¹ä¸º 4 å€
}
```

è®°å¾—ä¸‹è½½å¯¹åº”æ¨¡å‹:
```bash
# ä¸‹è½½ x4 æ¨¡å‹
wget https://github.com/xinntao/Real-ESRGAN/releases/download/v0.1.0/RealESRGAN_x4plus.pth -P resources/models/
```

#### æ€§èƒ½ä¼˜åŒ–

**CPU ç¯å¢ƒ:**
```json
{
    "name_": "RealESRGAN_2",
    "scale_": 2,
    "tile_": 256  // å¯ç”¨ tile æ¨¡å¼å‡å°‘å†…å­˜å ç”¨
}
```

**GPU ç¯å¢ƒ:**
- è‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨ CUDA (å¦‚æœå¯ç”¨)
- é€Ÿåº¦æå‡ 10-20 å€
- ç¡®ä¿å®‰è£…äº† CUDA ç‰ˆæœ¬çš„ PyTorch

---

### SRResNet-lite å·¥ä½œæµ

#### èŠ‚ç‚¹è¯´æ˜

1. **OpenCvVideoDecode_1** (è§†é¢‘è¾“å…¥)
   - åŒ Real-ESRGAN

2. **SRResNet_2** (è¶…åˆ†èŠ‚ç‚¹)
   - å‚æ•°:
     - `model_path_`: é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„ (å¯é€‰,é»˜è®¤: `null`)
     - `scale_`: è¶…åˆ†å€æ•° (2 æˆ– 4, é»˜è®¤: 2)
     - `num_features_`: ç‰¹å¾é€šé“æ•° (32=lite, 64=standard, é»˜è®¤: 32)
     - `num_blocks_`: æ®‹å·®å—æ•°é‡ (8=lite, 16=standard, é»˜è®¤: 8)

3. **OpenCvImshow_3** (æ˜¾ç¤ºè¾“å‡º)
   - åŒ Real-ESRGAN

#### é…ç½®é€‰é¡¹

**Lite é…ç½® (é€Ÿåº¦ä¼˜å…ˆ):**
```json
{
    "name_": "SRResNet_2",
    "scale_": 2,
    "num_features_": 32,
    "num_blocks_": 8
}
```
- å‚æ•°é‡: ~5M
- CPU é€Ÿåº¦: 20 FPS
- è´¨é‡: ä¸­ç­‰

**Standard é…ç½® (è´¨é‡ä¼˜å…ˆ):**
```json
{
    "name_": "SRResNet_2",
    "scale_": 2,
    "num_features_": 64,
    "num_blocks_": 16
}
```
- å‚æ•°é‡: ~15M
- CPU é€Ÿåº¦: 8-10 FPS
- è´¨é‡: é«˜

**ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹:**
```json
{
    "name_": "SRResNet_2",
    "model_path_": "resources/models/srresnet_x2.pth",
    "scale_": 2,
    "num_features_": 32,
    "num_blocks_": 8
}
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### 1. Real-ESRGAN èŠ‚ç‚¹åˆå§‹åŒ–å¤±è´¥

**é”™è¯¯**: `No module named 'realesrgan'`

**è§£å†³**:
```bash
pip install realesrgan basicsr facexlib
```

### 2. æ¨¡å‹æ–‡ä»¶ä¸å­˜åœ¨

**é”™è¯¯**: `FileNotFoundError: RealESRGAN_x2plus.pth`

**è§£å†³**:
```bash
# ä¸‹è½½æ¨¡å‹åˆ°æ­£ç¡®è·¯å¾„
mkdir -p resources/models
cd resources/models
wget https://github.com/xinntao/Real-ESRGAN/releases/download/v0.2.1/RealESRGAN_x2plus.pth
```

### 3. SRResNet èŠ‚ç‚¹åˆå§‹åŒ–å¤±è´¥

**é”™è¯¯**: `No module named 'torch'`

**è§£å†³**:
```bash
# CPU ç‰ˆæœ¬
pip install torch torchvision --index-url https://download.pytorch.org/whl/cpu

# GPU ç‰ˆæœ¬
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118
```

### 4. GPU ä¸å¯ç”¨

**é”™è¯¯**: `CUDA out of memory` æˆ– `device cuda not available`

**è§£å†³**:
- æ£€æŸ¥ CUDA æ˜¯å¦å®‰è£…: `python -c "import torch; print(torch.cuda.is_available())"`
- å¦‚æœè¿”å› `False`, ä½¿ç”¨ CPU æ¨¡å¼ (è‡ªåŠ¨å›é€€)
- å¦‚æœæ˜¾å­˜ä¸è¶³, å‡å°è¾“å…¥åˆ†è¾¨ç‡æˆ–ä½¿ç”¨ tile æ¨¡å¼

### 5. å¤„ç†é€Ÿåº¦æ…¢

**è§£å†³æ–¹æ¡ˆ**:

#### æ–¹æ¡ˆ1: åˆ‡æ¢åˆ°æ›´å¿«çš„æ¨¡å‹
```
GFPGAN (2 FPS) â†’ Real-ESRGAN (4-6 FPS) â†’ SRResNet-lite (20 FPS)
```

#### æ–¹æ¡ˆ2: é™ä½è§†é¢‘åˆ†è¾¨ç‡
```bash
# ä½¿ç”¨ ffmpeg é™ä½åˆ†è¾¨ç‡
ffmpeg -i input.mp4 -vf "scale=480:-1" input_480p.mp4
```

#### æ–¹æ¡ˆ3: ä½¿ç”¨ GPU åŠ é€Ÿ
- å®‰è£… CUDA å’Œ GPU ç‰ˆæœ¬ PyTorch
- é€Ÿåº¦æå‡ 10-20 å€

#### æ–¹æ¡ˆ4: å¯ç”¨ Tile æ¨¡å¼ (Real-ESRGAN)
```json
{
    "name_": "RealESRGAN_2",
    "tile_": 256  // å¯ç”¨ 256x256 tile å¤„ç†
}
```

### 6. è¾“å‡ºè´¨é‡ä¸ä½³ (SRResNet)

**åŸå› **: SRResNet ä½¿ç”¨éšæœºåˆå§‹åŒ–,æœªåŠ è½½é¢„è®­ç»ƒæƒé‡

**è§£å†³**:
1. è®­ç»ƒè‡ªå·±çš„æ¨¡å‹
2. å¯»æ‰¾å¼€æºé¢„è®­ç»ƒæƒé‡
3. åˆ‡æ¢åˆ° Real-ESRGAN æˆ– GFPGAN

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”æµ‹è¯•

### æµ‹è¯•ç¯å¢ƒ
- **è¾“å…¥**: 640x480 @ 30fps
- **è¾“å‡º**: 1280x960 (2å€è¶…åˆ†)
- **CPU**: Intel i7-10700
- **GPU**: NVIDIA RTX 3060

### æµ‹è¯•ç»“æœ

| å·¥ä½œæµ | CPUæ¨ç†æ—¶é—´ | CPU FPS | GPUæ¨ç†æ—¶é—´ | GPU FPS | è´¨é‡è¯„åˆ† |
|--------|------------|---------|------------|---------|---------|
| GFPGAN | 500ms | 2 | 50ms | 20 | 9.5/10 |
| Real-ESRGAN | 250ms | 4 | 25ms | 40 | 8.5/10 |
| SRResNet-lite (32/8) | 50ms | 20 | 5ms | 200 | 6.5/10 |
| SRResNet-std (64/16) | 120ms | 8 | 10ms | 100 | 7.5/10 |

### æ¨èé…ç½®

#### ğŸ¯ æœ€é«˜è´¨é‡ (ç¦»çº¿å¤„ç†)
- **å·¥ä½œæµ**: `å®æ—¶è§†é¢‘è¶…åˆ†.json` (GFPGAN)
- **ç¡¬ä»¶**: CPU å¯ç”¨,ä½†å»ºè®® GPU
- **åœºæ™¯**: ç…§ç‰‡ä¿®å¤,äººè„¸è¶…åˆ†,é«˜è´¨é‡è¾“å‡º

#### âš¡ å¹³è¡¡è´¨é‡ä¸é€Ÿåº¦
- **å·¥ä½œæµ**: `RealESRGANè§†é¢‘è¶…åˆ†.json`
- **ç¡¬ä»¶**: CPU + é€‚å½“é™åˆ†è¾¨ç‡,æˆ– GPU
- **åœºæ™¯**: é€šç”¨è¶…åˆ†,è§†é¢‘å¢å¼º,åœ¨çº¿å¤„ç†

#### ğŸš€ å®æ—¶å¤„ç† (CPU)
- **å·¥ä½œæµ**: `SRResNetè§†é¢‘è¶…åˆ†.json` (Lite é…ç½®)
- **ç¡¬ä»¶**: CPU å¯å®æ—¶
- **åœºæ™¯**: å¿«é€Ÿé¢„è§ˆ,ä½é…ç½®ç¯å¢ƒ,å®æ—¶æµå¤„ç†

#### ğŸ’ª è¶…é«˜é€Ÿå¤„ç† (GPU)
- **å·¥ä½œæµ**: ä»»æ„,æ¨è `RealESRGANè§†é¢‘è¶…åˆ†.json`
- **ç¡¬ä»¶**: NVIDIA GPU + CUDA
- **åœºæ™¯**: æ‰¹é‡å¤„ç†,é«˜åˆ†è¾¨ç‡è§†é¢‘,ç”Ÿäº§ç¯å¢ƒ

---

## ğŸ”— ç›¸å…³æ–‡ä»¶

åˆ›å»ºçš„æ–‡ä»¶:
- âœ… [python/nndeploy/super_resolution/__init__.py](../python/nndeploy/super_resolution/__init__.py)
- âœ… [python/nndeploy/super_resolution/realesrgan.py](../python/nndeploy/super_resolution/realesrgan.py)
- âœ… [python/nndeploy/super_resolution/srresnet.py](../python/nndeploy/super_resolution/srresnet.py)
- âœ… [resources/workflow/RealESRGANè§†é¢‘è¶…åˆ†.json](../resources/workflow/RealESRGANè§†é¢‘è¶…åˆ†.json)
- âœ… [resources/workflow/SRResNetè§†é¢‘è¶…åˆ†.json](../resources/workflow/SRResNetè§†é¢‘è¶…åˆ†.json)
- âœ… [docs/è§†é¢‘è¶…åˆ†å·¥ä½œæµä½¿ç”¨æŒ‡å—.md](è§†é¢‘è¶…åˆ†å·¥ä½œæµä½¿ç”¨æŒ‡å—.md) (æœ¬æ–‡æ¡£)

å‚è€ƒæ–‡æ¡£:
- ğŸ“– [OpenCvImshowèŠ‚ç‚¹è‡ªå®šä¹‰å®Œæ•´æŒ‡å—.md](OpenCvImshowèŠ‚ç‚¹è‡ªå®šä¹‰å®Œæ•´æŒ‡å—.md)
- ğŸ“– [è§†é¢‘è¶…åˆ†æ€§èƒ½ä¼˜åŒ–å®Œæ•´æŒ‡å—.md](è§†é¢‘è¶…åˆ†æ€§èƒ½ä¼˜åŒ–å®Œæ•´æŒ‡å—.md)
- ğŸ“– [è§†é¢‘è¶…åˆ†æ¨¡å‹å¯¹æ¯”æµ‹è¯•æŒ‡å—.md](è§†é¢‘è¶…åˆ†æ¨¡å‹å¯¹æ¯”æµ‹è¯•æŒ‡å—.md)

---

## ğŸ“ å·¥ä½œæµå¼€å‘è¯´æ˜

### å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰è¶…åˆ†èŠ‚ç‚¹

å‚è€ƒ [python/nndeploy/super_resolution/realesrgan.py](../python/nndeploy/super_resolution/realesrgan.py) çš„å®ç°:

1. **ç»§æ‰¿ `nndeploy.dag.Node`**
2. **å®ç°å¿…è¦æ–¹æ³•**:
   - `__init__`: åˆå§‹åŒ–å‚æ•°
   - `init`: åŠ è½½æ¨¡å‹
   - `run`: æ‰§è¡Œæ¨ç†
   - `serialize`/`deserialize`: å‚æ•°åºåˆ—åŒ–
3. **æ³¨å†ŒèŠ‚ç‚¹**:
   ```python
   node_creator = MyNodeCreator()
   nndeploy.dag.register_node("nndeploy.xxx.MyNode", node_creator)
   ```
4. **åˆ›å»º JSON å·¥ä½œæµ**: å‚è€ƒ [RealESRGANè§†é¢‘è¶…åˆ†.json](../resources/workflow/RealESRGANè§†é¢‘è¶…åˆ†.json)

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®æ›´å¤šè¶…åˆ†æ¨¡å‹èŠ‚ç‚¹:
- [ ] EDSR
- [ ] RCAN
- [ ] HAT
- [ ] SwinIR
- [ ] Real-CUGAN (åŠ¨æ¼«)
- [ ] Waifu2x (åŠ¨æ¼«)

æäº¤ PR æ—¶è¯·åŒ…å«:
1. Python èŠ‚ç‚¹å®ç°
2. JSON å·¥ä½œæµæ–‡ä»¶
3. ä½¿ç”¨æ–‡æ¡£
4. æ€§èƒ½æµ‹è¯•æ•°æ®

---

**ç¥ä½¿ç”¨æ„‰å¿«!** ğŸ‰
