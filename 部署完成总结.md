# nndeploy Android TV éƒ¨ç½²å®Œæˆæ€»ç»“

## âœ… å·²å®Œæˆçš„æ­¥éª¤

### 1. ç¯å¢ƒé…ç½®
- âœ… é…ç½®ç¯å¢ƒå˜é‡ï¼ˆ~/.zshrcï¼‰
  - ANDROID_SDK: `~/Library/Android/sdk`
  - ANDROID_NDK: `~/Library/Android/sdk/ndk/29.0.14206865`
  - PATH å·²åŒ…å« NDK è·¯å¾„

### 2. ä¾èµ–å®‰è£…
- âœ… Homebrew å·¥å…·
  - CMake 4.2.0
  - Ninja 1.13.2
  
- âœ… Git å­æ¨¡å—
  - å·²åˆå§‹åŒ–å…¨éƒ¨8ä¸ªå­æ¨¡å—ï¼ˆrapidjson, gflagsç­‰ï¼‰

- âœ… ç¬¬ä¸‰æ–¹åº“ä¸‹è½½å’Œé…ç½®
  - ONNXRuntime 1.18.0 Android (23.2MB)
  - OpenCV 4.10.0 Android SDK (292MB)
  - ç›®å½•ï¼š`/Users/jin/work/nndeploy/tool/script/third_party/`

### 3. CMake é…ç½®ä¿®å¤
- âœ… ä¿®å¤ CMake ç‰ˆæœ¬å…¼å®¹æ€§
  - third_party/rapidjson/CMakeLists.txt: VERSION 2.8.12 â†’ 3.5
  - third_party/gflags/CMakeLists.txt: VERSION 3.0.2 â†’ 3.5
  
- âœ… ä¿®å¤ ONNXRuntime å¤´æ–‡ä»¶è·¯å¾„
  - cmake/onnxruntime.cmake: æ·»åŠ  `include/onnxruntime` è·¯å¾„

### 4. ç¼–è¯‘é…ç½®
- âœ… åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š`build_android_arm64/config.cmake`
  - å¯ç”¨ ONNXRuntime: `tool/script/third_party/onnxruntime1.18.0_android`
  - å¯ç”¨ OpenCV: `tool/script/third_party/opencv4.10.0_Android`
  - ç¦ç”¨ MNN, LLM, StableDiffusion
  - ç›®æ ‡æ¶æ„ï¼šarm64-v8a
  - Android API Level: 24
  - STL: c++_shared

### 5. ç¼–è¯‘æ„å»º
- âœ… CMake é…ç½®æˆåŠŸ
- âœ… Ninja ç¼–è¯‘æˆåŠŸï¼ˆ298ä¸ªæ–‡ä»¶ï¼‰
- âœ… ç”ŸæˆåŠ¨æ€åº“æ–‡ä»¶ï¼ˆå…±15ä¸ª .so æ–‡ä»¶ï¼‰

### 6. åº“æ–‡ä»¶éƒ¨ç½²
- âœ… æ‰€æœ‰åº“å·²å¤åˆ¶åˆ° Android é¡¹ç›®ï¼š
  - ç›®æ ‡ç›®å½•ï¼š`app/android/app/src/main/jniLibs/arm64-v8a/`
  - å·²å¤åˆ¶æ–‡ä»¶ï¼ˆå…±18ä¸ªï¼Œçº¦230MBï¼‰ï¼š
    ```
    libc++_shared.so           (8.9MB)  - NDK C++ è¿è¡Œæ—¶
    libnndeploy_framework.so   (36MB)   - nndeploy æ ¸å¿ƒæ¡†æ¶
    libnndeploy_jni.so         (189KB)  - JNI æ¥å£
    libnndeploy_plugin_*.so    (å¤šä¸ª)   - å„åŠŸèƒ½æ’ä»¶
    libonnxruntime.so          (16MB)   - ONNXRuntime æ¨ç†å¼•æ“
    libopencv_java4.so         (20MB)   - OpenCV è§†è§‰åº“
    ```

### 7. Android é¡¹ç›®ç»“æ„
- âœ… JNI åº“ç›®å½•ï¼š`app/android/app/src/main/jniLibs/arm64-v8a/`
- âœ… Assets ç›®å½•ï¼š`app/android/app/src/main/assets/`ï¼ˆå·²åˆ›å»ºï¼Œå¾…æ”¾å…¥æ¨¡å‹ï¼‰
- âœ… JNI åŠ è½½ä»£ç ï¼š`GraphRunner.kt` ä¸­å·²å®ç°
  ```kotlin
  System.loadLibrary("nndeploy_jni")
  ```

## ğŸ“‹ ä¸‹ä¸€æ­¥æ“ä½œ

### 1. åœ¨ Android Studio ä¸­æ‰“å¼€é¡¹ç›®
```bash
# é¡¹ç›®è·¯å¾„
/Users/jin/work/nndeploy/app/android
```

### 2. å‡†å¤‡æ¨¡å‹æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
- å°† .onnx æ¨¡å‹æ–‡ä»¶å¤åˆ¶åˆ° `app/src/main/assets/` ç›®å½•
- å°† workflow JSON é…ç½®æ–‡ä»¶å¤åˆ¶åˆ° `app/src/main/assets/` ç›®å½•

### 3. æ„å»º APK
åœ¨ Android Studio ä¸­ï¼š
1. æ‰“å¼€é¡¹ç›®ï¼šFile â†’ Open â†’ é€‰æ‹© `/Users/jin/work/nndeploy/app/android`
2. ç­‰å¾… Gradle åŒæ­¥å®Œæˆ
3. Build â†’ Make Projectï¼ˆæˆ– âŒ˜F9ï¼‰
4. Build â†’ Build Bundle(s) / APK(s) â†’ Build APK(s)

### 4. éƒ¨ç½²åˆ° Android TV
ä¸¤ç§æ–¹å¼ï¼š

**æ–¹å¼ä¸€ï¼šUSBè°ƒè¯•ï¼ˆæ¨èï¼‰**
1. Android TV å¼€å¯å¼€å‘è€…é€‰é¡¹å’Œ USB è°ƒè¯•
2. USB è¿æ¥ Mac å’Œ Android TV
3. Android Studio ä¸­ç‚¹å‡» Runï¼ˆæˆ– âŒƒRï¼‰
4. é€‰æ‹©ç›®æ ‡è®¾å¤‡ï¼ˆAndroid TVï¼‰

**æ–¹å¼äºŒï¼šç½‘ç»œè°ƒè¯•ï¼ˆWiFi ADBï¼‰**
```bash
# 1. é¦–æ¬¡éœ€è¦USBè¿æ¥ï¼Œè·å–Android TVçš„IPåœ°å€
adb devices

# 2. å¯ç”¨ç½‘ç»œè°ƒè¯•ï¼ˆAndroid TV IPä¸ºç¤ºä¾‹ï¼‰
adb tcpip 5555

# 3. é€šè¿‡WiFiè¿æ¥
adb connect <Android_TV_IP>:5555

# 4. åœ¨Android Studioä¸­Runå³å¯
```

## ğŸ“‚ å…³é”®è·¯å¾„æ€»ç»“

| ç›®å½•/æ–‡ä»¶ | è·¯å¾„ | è¯´æ˜ |
|---------|------|------|
| é¡¹ç›®æ ¹ç›®å½• | `/Users/jin/work/nndeploy` | nndeploy ä¸»é¡¹ç›® |
| æ„å»ºç›®å½• | `build_android_arm64/` | CMake æ„å»ºè¾“å‡º |
| ç¬¬ä¸‰æ–¹åº“ | `tool/script/third_party/` | ONNXRuntime & OpenCV |
| Android é¡¹ç›® | `app/android/` | Android Studio é¡¹ç›® |
| JNI åº“ç›®å½• | `app/android/app/src/main/jniLibs/arm64-v8a/` | æ‰€æœ‰ .so æ–‡ä»¶ |
| Assets ç›®å½• | `app/android/app/src/main/assets/` | æ¨¡å‹å’Œé…ç½®æ–‡ä»¶ |
| é…ç½®æ–‡ä»¶ | `build_android_arm64/config.cmake` | CMake æ„å»ºé…ç½® |

## ğŸ”§ æŠ€æœ¯æ ˆä¿¡æ¯

| ç»„ä»¶ | ç‰ˆæœ¬ | ç”¨é€” |
|-----|------|------|
| Android NDK | 29.0.14206865 | åŸç”Ÿä»£ç ç¼–è¯‘ |
| Android SDK | 34 (compileSdk) | Android å¼€å‘ |
| Min SDK | 24 | æœ€ä½æ”¯æŒ Android 7.0 |
| ONNXRuntime | 1.18.0 | AI æ¨¡å‹æ¨ç† |
| OpenCV | 4.10.0 | è®¡ç®—æœºè§†è§‰ |
| CMake | 4.2.0 | æ„å»ºç³»ç»Ÿ |
| Ninja | 1.13.2 | ç¼–è¯‘å·¥å…· |
| Kotlin | 1.5.14 (Compose) | Android åº”ç”¨å¼€å‘ |

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡æ„å»º**ï¼šGradle åŒæ­¥å¯èƒ½éœ€è¦ä¸‹è½½ä¾èµ–ï¼Œè¯·ç¡®ä¿ç½‘ç»œè¿æ¥æ­£å¸¸
2. **æ¨¡å‹æ–‡ä»¶**ï¼šå¦‚éœ€æµ‹è¯•AIåŠŸèƒ½ï¼Œéœ€å‡†å¤‡å¯¹åº”çš„ .onnx æ¨¡å‹æ–‡ä»¶
3. **Android TV å…¼å®¹æ€§**ï¼šç¡®ä¿ç›®æ ‡è®¾å¤‡æ”¯æŒ arm64-v8a æ¶æ„
4. **æ—¥å¿—æŸ¥çœ‹**ï¼šè¿è¡Œæ—¶å¯é€šè¿‡ Logcat æŸ¥çœ‹ nndeploy æ—¥å¿—è¾“å‡º
5. **æ€§èƒ½ä¼˜åŒ–**ï¼šé¦–æ¬¡åŠ è½½æ¨¡å‹å¯èƒ½è¾ƒæ…¢ï¼Œå»ºè®®åœ¨å®é™…ä½¿ç”¨ä¸­æ·»åŠ åŠ è½½è¿›åº¦æç¤º

## ğŸ¯ æµ‹è¯•å»ºè®®

1. å…ˆåœ¨ Android æ¨¡æ‹Ÿå™¨ï¼ˆarm64ï¼‰ä¸Šæµ‹è¯•åŸºæœ¬åŠŸèƒ½
2. æµ‹è¯• JNI è°ƒç”¨æ˜¯å¦æ­£å¸¸ï¼ˆæŸ¥çœ‹ Logcat æ—¥å¿—ï¼‰
3. æµ‹è¯•ç®€å•çš„æ¨ç†ä»»åŠ¡ï¼ˆå¦‚å›¾åƒåˆ†ç±»ï¼‰
4. é€æ­¥æµ‹è¯•å¤æ‚åŠŸèƒ½ï¼ˆæ£€æµ‹ã€åˆ†å‰²ç­‰ï¼‰
5. æœ€åéƒ¨ç½²åˆ°å®é™… Android TV è®¾å¤‡

## ğŸ“ æ•…éšœæ’æŸ¥

å¦‚é‡åˆ°é—®é¢˜ï¼š

1. **JNI åŠ è½½å¤±è´¥**
   - æ£€æŸ¥ jniLibs ç›®å½•ä¸‹æ‰€æœ‰ .so æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   - æŸ¥çœ‹ Logcat ä¸­çš„ UnsatisfiedLinkError è¯¦ç»†ä¿¡æ¯

2. **æ¨ç†å¤±è´¥**
   - ç¡®è®¤æ¨¡å‹æ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼ˆ.onnxï¼‰
   - æ£€æŸ¥ ONNXRuntime ç‰ˆæœ¬å…¼å®¹æ€§
   - æŸ¥çœ‹ nndeploy æ—¥å¿—è¾“å‡º

3. **ç¼–è¯‘é”™è¯¯**
   - æ¸…ç†é¡¹ç›®ï¼šBuild â†’ Clean Project
   - é‡æ–°åŒæ­¥ï¼šFile â†’ Sync Project with Gradle Files
   - æ£€æŸ¥ NDK ç‰ˆæœ¬æ˜¯å¦æ­£ç¡®

---

**éƒ¨ç½²å®Œæˆæ—¶é—´**ï¼š2024-12-09  
**æ„å»ºå¹³å°**ï¼šmacOS (Apple Silicon)  
**ç›®æ ‡å¹³å°**ï¼šAndroid TV (arm64-v8a, API 24+)
